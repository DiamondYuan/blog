---
title: JavaScript 高级程序设计读书笔记 第 9 章 客户端检测
date: 20120-04-24 10:27
toc: true
thumbnail: https://blog-staticfile.diamondyuan.com/2019-08-26-code.jpg
---

# 第 9 章 客户端检测

## 9.1 能力检测

检测的目标不是识别特定的浏览器，而是识别浏览器的能力。
两个重要的概念

- 第一个概念就是先检测达成目的的最常用的特性。
- 第二个重要的概念就是必须测试实际要用到的特性。一个特性存在,不一定意味着另一个特性也存在。

### 9.1.1 更可靠的能力检测

略

### 9.1.2 能力检测，不是浏览器检测

略，见标题。

## 9.2 怪癖检测

略

## 9.3 用户代理 (User Agent) 检测

略

## 9.4 小结

客户端检测是 Javascript 开发中最具争议的一个话题。由于浏览器间存在差別,通常需要根据不同浏览器的能力分别编写不同的代码。有不少客户端检测方法,但下列是最经常使用的。

- 能力检測:在编写代码之前先检测特定浏览器的能力。例如,脚本在调用某个函数之前,可能要先检测该函数是否存在。这种检测方法将开发人员从考虑具体的浏览器类型和版本中解放出来,让他们把注意力集中到相应的能力是否存在上。能力检测无法精确地检测特定的浏览器和版本。
- 怪癖检测:怪癖实际上是浏览器实现中存在的 bug,例如早期的 Webkit 中就存在一个怪癖,即它会在 for-in 循环中返回被隐藏的属性。怪癖检测通常涉及到运行一小段代码,然后确定浏览器是否存在某个怪癖。由于怪癖检测与能力检測相比效率更低,因此应该只在某个怪癖会干扰脚本运行的情况下使用。怪癖检测无法精确地检测特定的浏览器和版本
- 用户代理检测:通过检测用户代理字符串来识别浏览器。用户代理字符串中包含大量与浏览器有关的信息,包括浏览器、平台、操作系统及浏览器版本。用户代理字符串有过一段相当长的发展历史,在此期间,浏览器提供商试图通过在用户代理字符串中添加一些欺骗性信息,欺骗网站相信自己的浏览器是另外一种浏览器。用户代理检测需要特殊的技巧,特别是要注意思 Opera 会隐瞒其用户代理字符串的情况。即便如此,通过用户代理字符串仍然能够检测出测览器所用的呈现引擎以及所在的平台,包括移动设备和游戏系统。
  在决定使用哪种客户端检测方法时,一般应优先考虑使用能力检测。怪癖检测是确定应该如何处理代码的第二选择。而用户代理检测则是客户端检测的最后一种方案,因为这种方法对用户代理字符串具有很强的依赖性。
